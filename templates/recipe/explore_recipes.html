{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />
  <title>Recipe&#39;s Home - Recipe Box</title>
  <!-- Existing CSS and Preloader Styles -->

  <!-- Standard Django references, etc. -->
  <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.css' %}" />
  <link rel="stylesheet" type="text/css" href="{% static 'css/card.css' %}" />

  <link href="https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap" rel="stylesheet" />
  <link href="{% static 'css/font-awesome.min.css' %}" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/css/nice-select.min.css"
    integrity="sha256-mLBIhmBvigTFWPSCtvdu6a76T+3Xyt+K571hupeFLg4=" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.min.css"
    integrity="sha256-UK1EiopXIL+KVhfbFa8xrmAWPeBjMVdvYMYkTAEv/HI=" crossorigin="anonymous" />
  <link href="{% static 'css/style.css' %}" rel="stylesheet" />
  <link href="{% static 'css/responsive.css' %}" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Favicon -->
  <link rel="icon" type="image/png" sizes="16x16" href="{% static 'assets/images/favicon-16x16.png' %}" />
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'assets/images/favicon-32x32.png' %}" />
  <link rel="icon" type="image/png" sizes="192x192" href="{% static 'assets/images/android-chrome-192x192.png' %}" />
  <link rel="icon" type="image/png" sizes="512x512" href="{% static 'assets/images/android-chrome-512x512.png' %}" />
  <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/images/apple-touch-icon.png' %}" />
  <link rel="manifest" href="{% static 'assets/images/site.webmanifest' %}" />

  <style>
    :root {
    --font-retro-heading: 'Helvetica', 'Arial', sans-serif;
    --font-retro-body: 'Helvetica', 'Arial', sans-serif;
  
    --retro-background: #e6e6e6;
    --retro-card: #ffffff;
    --retro-primary: #6b5b95;
    --retro-secondary: #3a7d89;
    --retro-accent: #d64161;
    --retro-text: #333333;
    --retro-text-light: #777777;
    --retro-border: #cccccc;
    --retro-highlight: #e9724c;
    --retro-gradient-1: #6b5b95;
    --retro-gradient-2: #5d4f83;
  }
  
  .cards-container.geometric-luxury .recipe-card {
    background-color: var(--retro-card);
    border-radius: 16px;
    overflow: hidden;
    position: relative;
    box-shadow: 6px 6px 0 rgba(0, 0, 0, 0.2);
    font-family: var(--font-retro-body);
    color: var(--retro-text);
    padding: 0;
    border: 2px solid var(--retro-primary);
    transition: all 0.3s ease;
  }
  
  /* Removed pattern overlay */
  /* Removed cuisine badge */
  
  .cards-container.geometric-luxury .recipe-card:hover {
    transform: translateY(-4px);
    box-shadow: 8px 8px 0 rgba(0, 0, 0, 0.2);
    border-color: var(--retro-secondary);
  }
  
  .cards-container.geometric-luxury .card-image {
    position: relative;
    overflow: hidden;
    height: 220px;
    border-bottom: 4px solid var(--retro-primary);
    border-top-left-radius: 16px;
    border-top-right-radius: 16px;
  }
  
  .cards-container.geometric-luxury .card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
    filter: saturate(1.2);
  }
  
  .cards-container.geometric-luxury .recipe-card:hover .card-image img {
    transform: scale(1.05);
  }
  
  .cards-container.geometric-luxury .card-image::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.4) 0%,
      rgba(0, 0, 0, 0) 60%
    );
    z-index: 1;
  }
  
  .cards-container.geometric-luxury .card-content {
    padding: 1.75rem;
    position: relative;
    z-index: 2;
    background-color: var(--retro-card);
    border-bottom-left-radius: 16px;
    border-bottom-right-radius: 16px;
  }
  
  .cards-container.geometric-luxury .card-content::before {
    content: "";
    position: absolute;
    top: 0;
    left: 20px;
    width: 50px;
    height: 4px;
    background: var(--retro-accent);
    transform: translateY(-50%);
    transition: width 0.3s ease;
  }
  
  .cards-container.geometric-luxury .recipe-card:hover .card-content::before {
    width: 70px;
  }
  
  .cards-container.geometric-luxury .recipe-title {
    font-family: var(--font-retro-heading);
    color: var(--retro-primary);
    font-size: 1.5rem;
    font-weight: 700;
    line-height: 1.3;
    margin-bottom: 0.8rem;
    transition: color 0.3s ease;
    border-bottom: 2px solid var(--retro-border);
    padding-bottom: 0.8rem;
    text-transform: uppercase;
  }
  
  .cards-container.geometric-luxury .recipe-card:hover .recipe-title {
    color: var(--retro-secondary);
  }
  
  .cards-container.geometric-luxury .recipe-stats {
    display: flex;
    justify-content: flex-start;
    gap: 1.5rem;
    margin: 1.25rem 0;
    padding-bottom: 1.25rem;
    border-bottom: 2px solid var(--retro-border);
  }
  
  .cards-container.geometric-luxury .stat-item {
    display: flex;
    align-items: center;
    font-family: var(--font-retro-body);
    font-size: 0.85rem;
    color: var(--retro-text-light);
    font-weight: 600;
  }
  
  .cards-container.geometric-luxury .stat-item svg {
    color: var(--retro-primary);
    margin-right: 0.5rem;
    transition: transform 0.3s ease;
  }
  
  .cards-container.geometric-luxury .recipe-card:hover .stat-item svg {
    transform: scale(1.15);
    color: var(--retro-secondary);
  }
  
  .cards-container.geometric-luxury .ingredients-preview {
    list-style: none;
    margin: 1.25rem 0;
    padding: 1rem;
    background: rgba(230, 230, 230, 0.5);
    border-radius: 8px;
    border-left: 4px solid var(--retro-primary);
  }
  
  .cards-container.geometric-luxury .ingredients-preview h3 {
    font-family: var(--font-retro-heading);
    color: var(--retro-primary);
    font-size: 1.1rem;
    font-weight: 700;
    margin-bottom: 0.8rem;
    letter-spacing: 0.03em;
    border-bottom: 2px solid rgba(204, 204, 204, 0.5);
    padding-bottom: 0.5rem;
    text-transform: uppercase;
  }
  
  .cards-container.geometric-luxury .ingredients-preview li {
    position: relative;
    padding-left: 1.5rem;
    margin-bottom: 0.5rem;
    color: var(--retro-text);
    font-size: 0.9rem;
    line-height: 1.5;
  }
  
  .cards-container.geometric-luxury .ingredients-preview li::before {
    content: "â– ";
    display: block;
    position: absolute;
    left: 0;
    top: 0;
    color: var(--retro-primary);
    transition: all 0.3s ease;
  }
  
  .cards-container.geometric-luxury .recipe-card:hover .ingredients-preview li::before {
    color: var(--retro-secondary);
  }
  
  .cards-container.geometric-luxury .card-actions {
    display: flex;
    justify-content: space-between;
    margin-top: 1.5rem;
    gap: 12px;
  }
  
  .cards-container.geometric-luxury .btn-primary {
    font-family: var(--font-retro-body);
    font-weight: 700;
    font-size: 0.95rem;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    background: var(--retro-primary);
    color: white;
    border: none;
    position: relative;
    transition: all 0.3s ease;
    box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.2);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  } 
  
  .cards-container.geometric-luxury .btn-primary:hover {
    background: var(--retro-secondary);
    transform: translateY(-2px);
    box-shadow: 4px 4px 0 rgba(0, 0, 0, 0.25);
  }
  
  






  @import url('https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap');

/* Base card style */
.cards-container.modern-edge .recipe-card {
  position: relative;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border-radius: 4px;
  background-color: #fff5e6;
  background-image: 
    linear-gradient(to bottom, rgba(0,0,0,0.03) 0%, transparent 20%),
    repeating-linear-gradient(
      to bottom, 
      transparent 0px, 
      transparent 23px,
      rgba(0,0,0,0.07) 23px,
      rgba(0,0,0,0.07) 24px
    ),
    repeating-linear-gradient(
      to right,
      #ffd9aa 0px,
      #ffd9aa 1px,
      transparent 1px,
      transparent 40px
    );
  box-shadow: 
    0 2px 5px rgba(0,0,0,0.15),
    inset 0 -20px 50px rgba(0,0,0,0.05);
  border: 2px solid #e0d0b0;
  transform: rotate(-0.5deg);
  transition: transform 0.3s ease;
  font-family: 'Patrick Hand', cursive;
}

/* Hand-drawn border effect */
.cards-container.modern-edge .recipe-card::before {
  content: "";
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  border: 2px solid #c0a080;
  border-radius: 8px;
  clip-path: polygon(
    0% 5%, 5% 0%, 95% 0%, 100% 5%,
    100% 95%, 95% 100%, 5% 100%, 0% 95%
  );
}

/* Coffee stain effects */
.cards-container.modern-edge .recipe-card::after {
  content: "";
  position: absolute;
  background: rgba(100,60,30,0.08);
  border-radius: 50%;
  transform: rotate(30deg);
}

/* Random coffee stain positions */
.cards-container.modern-edge .recipe-card::after {
  width: 80px;
  height: 60px;
  top: 10px;
  right: -20px;
  clip-path: ellipse(25% 40% at 50% 50%);
}

/* Image container */
.cards-container.modern-edge .card-image {
  position: relative;
  overflow: hidden;
  margin: 15px 15px 10px;
  border: 3px solid #d0c0a0;
  border-radius: 8px;
  box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
  transform: rotate(0.5deg);
}

.cards-container.modern-edge .card-image img {
  width: 100%;
  height: auto;
  filter: sepia(0.3) contrast(0.9);
}

/* Recipe title */
.cards-container.modern-edge .recipe-title {
  font-family: 'Patrick Hand', cursive;
  font-size: 2.1 rem;
  color: #604020;
  margin: 0 15px;
  padding-bottom: 5px;
  border-bottom: 3px double #d0c0a0;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
}

/* Card content */
.cards-container.modern-edge .card-content {
  padding: 10px 20px;
  color: #705040;
  font-size: 1.3rem;
  line-height: 1.4;
  text-align: justify;
}

/* Ingredients list */
.cards-container.modern-edge .card-content ul {
  list-style: none;
  padding-left: 25px;
}

.cards-container.modern-edge .card-content li::before {
  content: "~ ";
  color: #c0a080;
}

/* Button group */
.cards-container.modern-edge .button-group {
  display: flex;
  gap: 10px;
  padding: 10px 20px 20px;
}

/* Buttons */
.cards-container.modern-edge .btn-primary,
.cards-container.modern-edge .btn-secondary {
  padding: 8px 20px;
  border: 2px solid #806040;
  border-radius: 15px;
  font-family: 'Patrick Hand', cursive;
  font-size: 1.2rem;
  cursor: pointer;
  transition: all 0.2s ease;
  background: #fff0e0;
  color: #705040;
  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  transform: rotate(-0.5deg);
}

/* Updated Button Hover Effects */
.cards-container.modern-edge .btn-primary:hover {
  background-color: #b09870;
  color: #fff5e6;
  border-color: #705040;
  box-shadow: 3px 3px 5px rgba(0,0,0,0.2);
}

.cards-container.modern-edge .btn-secondary:hover {
  background-color: #fff0e0;
  color: #604020;
  border-style: solid;
  box-shadow: 3px 3px 5px rgba(0,0,0,0.15);
}

.cards-container.modern-edge .cuisine-badge {
  position: absolute;
  top: 10px;
  right: 10px; /* Moved to right */
  background: #d8cbb1;
  color: #604020;
  padding: 6px 12px; /* Reduced padding */
  font-size: 1rem;
  border-radius: 12px;
  border: 2px dashed #c0a080;
  transform: rotate(0deg); /* Optional: remove tilt for better alignment */
  z-index: 2;
  transition: all 0.3s ease;
  box-shadow: 2px 2px 4px rgba(0,0,0,0.1);
  max-width: 120px; /* Limit width */
  white-space: nowrap; /* Prevent text wrap */
  overflow: hidden;
  text-overflow: ellipsis;
}


.cards-container.modern-edge .cuisine-badge:hover {
  transform: rotate(2deg) scale(1.05);
  background: #c0a080;
  color: #fff5e6;
  border-style: solid;
  cursor: default;
}

/* Hover effect */
.cards-container.modern-edge .recipe-card:hover {
  transform: rotate(0deg) translateY(-5px);
  box-shadow: 
    0 5px 15px rgba(0,0,0,0.2),
    inset 0 -20px 50px rgba(0,0,0,0.08);
}

/* Responsive tweaks */
@media (max-width: 576px) {
  .cards-container.modern-edge .recipe-title {
    font-size: 1.8rem;
  }
  
  .cards-container.modern-edge .card-content {
    font-size: 1.1rem;
  }
  
  .cards-container.modern-edge .btn-primary,
  .cards-container.modern-edge .btn-secondary {
    font-size: 1rem;
    padding: 6px 15px;
  }

  .cards-container.modern-edge .cuisine-badge {
    font-size: 0.9rem;
    padding: 4px 12px;
    left: -8px;
  }
}

  </style>


  <title>Recipes</title>
</head>

<body>
  <!-- Preloader (Unchanged) -->
  <div class="preloader-overlay" id="preloader">
    <div class="preloader-container">
      <div class="dots-container">
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
        <div class="dot"></div>
      </div>
      <div class="preloader-progress">
        <div class="preloader-bar" id="progress-bar"></div>
      </div>
      <div class="loading-text" id="loading-text">Loading...</div>
    </div>
  </div>

  <!-- Main Content -->
  <div id="content">
    <div class="hero_area">
      <header class="header_section">
        <div class="container-fluid">
          <nav class="navbar navbar-expand-lg custom_nav-container">
            <a class="navbar-brand" href="{% url 'home' %}">
              <span>Recipe Box</span>
            </a>
            <div id="">
              <div class="User_option">
                {% if user.is_authenticated %}
                <a href="{% url 'user_pro' %}">
                  <i class="fa fa-user" aria-hidden="true"></i><span> Saved Recipes</span>
                </a>
                <a href="{% url 'logout_page' %}">
                  <i class="fa fa-user" aria-hidden="true"></i><span> Logout</span>
                </a>
                {% else %}
                <a href="{% url 'login_page' %}">
                  <i class="fa fa-user" aria-hidden="true"></i><span> Login</span>
                </a>
                {% endif %}
                <a href="/recipe/home/"><span>Home</span></a>
              </div>
            </div>
          </nav>
        </div>
      </header>

      <!-- Intro Slider Section -->
      <section class="slider_section">
        <div class="container">
          <div class="row">
            <div class="col-lg-10 mx-auto">
              <div class="detail-box">
                <h1>Discover Modern & Classic Recipes</h1>
                <p>"A food community where everyone shares their traditional recipes."</p>
              </div>
              <div class="find_container">
                <div class="container">
                  <div class="row">
                    <div class="col">
                      <form method="GET" action="{% url 'explore_recipes' %}">
                        <div class="form-row">
                          <div class="form-group col-lg-5">
                            <input type="text" class="form-control" id="inputHotel" name="Search"
                              placeholder="Search Recipes by Name" />
                          </div>
                          <div class="form-group col-lg-3">
                            <div class="btn-box">
                              <button type="submit" class="btn">Search</button>
                            </div>
                          </div>
                        </div>
                      </form>
                    </div><!-- /col -->
                  </div><!-- /row -->
                </div><!-- /container -->
              </div>
            </div>
          </div>
        </div>

        <div class="slider_container">
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img1.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img2.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img3.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img4.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img1.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img2.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img3.png" alt="" />
            </div>
          </div>
          <div class="item">
            <div class="img-box">
              <img src="/static/images/slider-img4.png" alt="" />
            </div>
          </div>
        </div>
      </section>
    </div>

<br>
{% if search_performed %}
<div class="style-controls">
      <button id="switchCardDesignBtn" class="style-btn">
        Design: <span id="currentStyle">Classic</span>
      </button>
    </div>
    {% endif %}


    <!-- Main recipe list area -->
    <div class="main">
      <div id="data-container">
        <!-- Existing content wrapped in this div -->
        {% include 'recipe/recipe_results.html' %}
      </div>
    </div>




    <!-- About section -->
    <section class="about_section layout_padding">
      <div class="container">
        <div class="col-md-11 col-lg-10 mx-auto">
          <div class="heading_container heading_center">
            <h2>About Us</h2>
          </div>
          <div class="box">
            <div class="col-md-7 mx-auto">
              <div class="img-box">
                <img src="{% static 'images/about-img.jpg' %}" class="box-img" alt="About Us" />
              </div>
            </div>
            <div class="detail-box">
              <p>
                Welcome to our food recipe website! We are passionate about
                sharing delicious recipes from around the world. Our mission
                is to inspire home cooks of all skill levels to explore new
                flavors and cuisines, and to provide them with easy-to-follow
                recipes and cooking tips. Whether you're a seasoned chef or
                just starting out in the kitchen, you'll find something
                delicious to try on our site.
              </p>
              <a href="{% url 'explore_recipes' %}">
                <i class="fa fa-arrow-right" aria-hidden="true"></i>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <div class="footer_container">
      <section class="info_section">
        <div class="container">
          <div class="social_box">
            <a href="https://www.instagram.com/roshan_ramani01?igsh=MWlpNWI2MWZmMDB6Yg%3D%3D&utm_source=qr">
              <i class="fa fa-instagram" aria-hidden="true"></i>
            </a>
            <a
              href="https://www.linkedin.com/in/roshan-ramani-0510102b2?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app">
              <i class="fa fa-linkedin" aria-hidden="true"></i>
            </a>
          </div>
        </div>
      </section>
      <footer class="footer_section">
  <!-- JS: Preloader logic (unchanged) -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      // Simulate loading process
      const progressBar = document.getElementById("progress-bar");
      const loadingText = document.getElementById("loading-text");
      let width = 0;
      const loadingInterval = setInterval(function () {
        if (width >= 100) {
          clearInterval(loadingInterval);
          loadingText.textContent = "Ready!";

          // Fade out preloader
          const preloader = document.getElementById("preloader");
          setTimeout(function () {
            preloader.style.opacity = "0";
            // Show content after preloader fades
            setTimeout(function () {
              preloader.style.display = "none";
              document.getElementById("content").style.display = "block";
            }, 500);
          }, 400);
        } else {
          width += 1;
          progressBar.style.width = width + "%";

          // Update loading text at certain percentages
          if (width === 25) {
            loadingText.textContent = "Loading assets...";
          } else if (width === 50) {
            loadingText.textContent = "Preparing content...";
          } else if (width === 75) {
            loadingText.textContent = "Almost there...";
          }
        }
      }, 30);
    });
  </script>

  <!-- JS: Prompt login if user not authenticated -->
  <script>
    function promptLogin() {
      if (confirm("Please log in to save your recipe. Would you like to log in now?")) {
        window.location.href = "{% url 'login_page' %}";
      }
    }
  </script>

  <!-- JS: "Change Style" logic - cycles through style classes -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const designs = [
        { name: 'Classic', class: 'classic-style' },
        { name: 'Journal', class: 'recipe-journal' },
        { name: 'Elegant', class: 'elegant-style' },
        { name: 'Modernâ€‘Edge', class: 'modern-edge' },
        { name: 'Vintageâ€‘Pastel', class: 'vintage-pastel' },
        { name: 'Retro Cardboard', class: 'retro-cardboard' },
        { name: 'Geometric Luxury', class: 'geometric-luxury' },
        // Add new designs here if needed
      ];
      const switchBtn = document.getElementById('switchCardDesignBtn');
      const currentStyleText = document.getElementById('currentStyle');
      // Always get the latest .cards-container after AJAX
      function getCardsContainer() {
        return document.querySelector('.cards-container');
      }
      // Fix: Clamp currentIndex to valid range
      function getValidIndex(idx) {
        if (isNaN(idx) || idx < 0 || idx >= designs.length) return 0;
        return idx;
      }
      let currentIndex = getValidIndex(parseInt(localStorage.getItem('selectedCardDesignIndex')));

      function animateCardsIn() {
        const cardsContainer = getCardsContainer();
        if (!cardsContainer) return;
        cardsContainer.classList.remove('animated');
        void cardsContainer.offsetWidth;
        cardsContainer.classList.add('animated');
      }

      function applyDesign() {
        const cardsContainer = getCardsContainer();
        if (!cardsContainer) return;
        currentIndex = getValidIndex(currentIndex);
        designs.forEach(d => cardsContainer.classList.remove(d.class));
        if (designs[currentIndex]) {
          cardsContainer.classList.add(designs[currentIndex].class);
          currentStyleText.textContent = designs[currentIndex].name;
        } else {
          cardsContainer.classList.add(designs[0].class);
          currentStyleText.textContent = designs[0].name;
        }
        animateCardsIn();
      }
      window.applyCardDesignAfterAjax = applyDesign;
      applyDesign();

      switchBtn.addEventListener('click', function () {
        const cardsContainer = getCardsContainer();
        if (!cardsContainer) return;
        cardsContainer.classList.remove('style-transition', 'animated');
        designs.forEach(d => cardsContainer.classList.remove(d.class));
        currentIndex = getValidIndex((currentIndex + 1) % designs.length);
        localStorage.setItem('selectedCardDesignIndex', currentIndex.toString());
        cardsContainer.classList.add(designs[currentIndex].class, 'style-transition');
        currentStyleText.textContent = designs[currentIndex].name;
        setTimeout(() => {
          cardsContainer.classList.remove('style-transition');
          animateCardsIn();
        }, 350);
      });

      document.addEventListener('keydown', function (e) {
        if (e.key === 'ArrowRight') {
          switchBtn.click();
        } else if (e.key === 'ArrowLeft') {
          const cardsContainer = getCardsContainer();
          if (!cardsContainer) return;
          cardsContainer.classList.remove('style-transition', 'animated');
          designs.forEach(d => cardsContainer.classList.remove(d.class));
          currentIndex = getValidIndex((currentIndex - 1 + designs.length) % designs.length);
          localStorage.setItem('selectedCardDesignIndex', currentIndex.toString());
          cardsContainer.classList.add(designs[currentIndex].class, 'style-transition');
          currentStyleText.textContent = designs[currentIndex].name;
          setTimeout(() => {
            cardsContainer.classList.remove('style-transition');
            animateCardsIn();
          }, 350);
        }
      });
    });
  </script>

<script>
  function loadPage(page) {
      const container = document.getElementById('data-container');
      const searchQuery = "{{ recipe_name|escapejs }}";
      // Get the selected card design index from localStorage
      const designIndex = localStorage.getItem('selectedCardDesignIndex') || 0;

      container.classList.add('loading');

      // Pass design index as a query parameter
      fetch(`?Search=${encodeURIComponent(searchQuery)}&page=${page}&design=${designIndex}`, {
          headers: {'X-Requested-With': 'XMLHttpRequest'}
      })
      .then(response => response.text())
      .then(html => {
          container.innerHTML = html;
          history.pushState({ page, designIndex }, '', `?Search=${searchQuery}&page=${page}&design=${designIndex}`);
          // Re-apply card design after AJAX content loads
          if (window.applyCardDesignAfterAjax) {
              window.applyCardDesignAfterAjax();
          }
      })
      .finally(() => container.classList.remove('loading'));
  }

  document.addEventListener('click', (e) => {
      const btn = e.target.closest('.pagination-btn');
      if (btn) {
          e.preventDefault();
          loadPage(parseInt(btn.dataset.page));
      }
  });

  window.addEventListener('popstate', (event) => {
      if (event.state?.page) {
          loadPage(event.state.page);
      }
  });
</script>

  <!-- jQuery, Bootstrap, etc. -->
  <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
  <script src="{% static 'js/bootstrap.js' %}"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.9.0/slick.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-nice-select/1.1.0/js/jquery.nice-select.min.js"
    integrity="sha256-Zr3vByTlMGQhvMfgkQ5BtWRSKBGa2QlspKYJnkjZTmo=" crossorigin="anonymous"></script>
  <script src="{% static 'js/custom.js' %}"></script>
</body>



</html>
``` 